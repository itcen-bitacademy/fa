<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="menu33">
	<!-- Team -->
	<insert id="purchaseitemadd" parameterType="purchaseitem33vo">
		<![CDATA[
		insert into tb_purchaseitem(no, name, price, produce_date, purpose, standard, section_code, factory_code, insert_userid, insert_day)
							 values(#{no }, #{name }, #{price }, #{produce_date }, #{purpose }, #{standard }, #{section_code }, #{factory_code }, #{insert_userid }, now())
		]]>
	</insert>
	
	<select id="factorycodeselect" resultType="int">
		<![CDATA[
		select count(*) from tb_factory
		]]>
	</select>
	
	<insert id="factoryadd" parameterType="factory33vo">
		<![CDATA[
		insert into tb_factory(no, name, address, manager_name, insert_userid, insert_day)
					   	select #{no }, #{name }, #{address }, #{manager_name }, #{insert_userid }, now()
							from dual where not exists
							(select * from tb_factory where name = #{name } and delete_flag = "N")
		]]>
	</insert>
	
	<update id="purchaseitemupdate" parameterType="purchaseitem33vo">
		<![CDATA[
		update tb_purchaseitem set name = #{name }, price = #{price }, produce_date = #{produce_date }, purpose = #{purpose }, standard = #{standard }, section_code = "001", factory_code = #{factory_code }, update_userid = "bbb", update_day = now()
							 where no = #{no }
		]]>
	</update>
	
	<update id="factoryupdate" parameterType="factory33vo">
		<![CDATA[
		update tb_factory set name = #{name }, address = #{address }, manager_name = #{manager_name }, update_userid = "bbb", update_day = now()
						where no = #{no }
		]]>
	</update>
	
	<update id="purchaseitemdelete" parameterType="purchaseitem33vo">
		<![CDATA[
		update tb_purchaseitem set delete_flag = "Y" where no = #{no }
		]]>
	</update>
	
	<update id="factorydelete" parameterType="factory33vo">
		<![CDATA[
		update tb_factory set delete_flag = "Y" where no = #{no }
		]]>
	</update>
	
	<select id="searchpurchaseitem" parameterType="int" resultType="purchaseitem33vo">
		<![CDATA[
		select no, name, price, produce_date, purpose, standard, section_code, factory_code from tb_purchaseitem where no = #{no }
		]]>
	</select>
	
	<select id="getsectionlist" resultType="sectionvo">
		<![CDATA[
		select no, classification, code, last_update as lastUpdate, parent_no as parentNo from tb_section where parent_no = 1
		]]>
	</select>
	
	<select id="getsearchsectionlist" parameterType="String" resultType="sectionvo">
		<![CDATA[
		select no, classification, code, last_update as lastUpdate, parent_no as parentNo from tb_section where parent_no = 1 and classification like #{sectionname }
		]]>
	</select>
</mapper>




