<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="menu37">
	<!-- 세금계산서 리스트 insert -->
	<insert id="insertTax" parameterType="buytaxbillvo">
		<![CDATA[
			insert 
			  into tb_buy_taxbill(no, manage_no, company_name, write_date, total_supply_value, total_tax_value, tax_type, insert_userid, insert_day)
			values (#{no },#{manageNo },#{companyName}, #{writeDate },#{totalSupplyValue },#{totalTaxValue },#{taxType },#{insertUserid },now())
		]]>
	</insert>

	<!-- 세금계산서에 맞는 품목 insert -->
	<insert id="insertItem" parameterType="buytaxbillitems">
		<![CDATA[
		insert
		  into tb_buy_taxbill_items
		values (null, #{taxbillNo }, #{purchaseDate }, #{itemName }, #{amount }, #{supplyValue }, #{taxValue }, #{insertUserid }, now(), null, null)
		]]>
		<selectKey keyProperty="no" resultType="long" order="AFTER">
			<![CDATA[
			select last_insert_id()
			]]>
		</selectKey>
	</insert>

	<!-- 승인번호로 조회했을 때 정보 select -->
	<select id="getAboutNoData" parameterType="String"
		resultType="buytaxbillvo">
		<![CDATA[
			select * 
			  from tb_buy_taxbill
			 where no = #{values }
		]]>
	</select>

	<!-- 승인번호로 조회했을 때 거래처명으로 같은 정보 가져오는 select -->
	<select id="getAboutNoCustomerData" parameterType="String"
		resultType="purchasecustomer35vo">
		<![CDATA[
		select *
		  from tb_purchasecustomer
		 where name = #{values }
		]]>
	</select>

	<!-- 승인번호로 조회했을때 거래처명을 가지고 은행정보 가져오는 select -->
	<select id="getAboutNoBankData" parameterType="String"
		resultType="bankaccountvo">
		<![CDATA[
			select *
			  from tb_bank_account
			 where deposit_no = #{values }
		]]>
	</select>


	<!-- 거래처명 리스트 중 클릭할시 관련정보 불러오는 select -->
	<select id="customerList" resultType="purchasecustomer35vo">
		<![CDATA[
			select *
		      from tb_purchasecustomer
		]]>
	</select>
	<select id="customerBankList" resultType="bankaccountvo">
		
		<![CDATA[
		  	select *
		      from tb_bank_account
		 ]]>
	</select>

	<!-- 승인번호에 맞는 품목리스트 select -->
	<select id="getAboutItmes" parameterType="String"
		resultType="buytaxbillitems">
		<![CDATA[
		  	select *
		      from tb_buy_taxbill_items
		     where taxbill_no = #{values }
		 ]]>
	</select>
</mapper>