<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="menu45">
	
	<!-- 은행테이블의 데이터 갯수 조회 -->
	<select id="selectBankListCount" resultType="int" parameterType="bankvo">
		<![CDATA[
			select	count(*)
				from tb_bank
		]]>
			<if test='deleteFlag==null or ("").equals(deleteFlag)'>
			<!-- code.length()>0 하면 에러남  -->
		 		<![CDATA[
		  		where delete_flag like concat('%',#{deleteFlag},'%')
		   		]]>
			</if>
			<if test='name!=null and !("").equals(name)'> 
			<!-- code.length()>0 하면 에러남  -->
 				<![CDATA[
  				and name like concat('%',#{name},'%') 
   				]]>
   			</if>
   			<if test='store!=null and !("").equals(store)'> 
			<!-- code.length()>0 하면 에러남  -->
 			  <![CDATA[
  			 and store like concat('%',#{store},'%') 
   			]]>
   			</if>
   			<if test='dealDate!=null and !("").equals(dealDate)'> 
			<!-- code.length()>0 하면 에러남  -->
 			  <![CDATA[
  			 and date_format(deal_date,'%Y-%m-%d') like concat('%',#{dealDate},'%') 
   			]]>
   			</if>
	</select>
	
	<!-- select list -->
	<select id="list" resultType="bankvo" parameterType="map">
		<![CDATA[
			select 
				code,
				name,
				store,
				date_format(deal_date,'%Y-%m-%d') as dealDate,
				phone, 
				fax,
				post, 
				address,
				mgr, 
				mgr_phone as mgrPhone,
				mgr_email as mgrEmail
			from tb_bank
			]]>
			
			<if test='deleteFlag==null or ("").equals(deleteFlag)'>
			<!-- code.length()>0 하면 에러남  -->
		 		<![CDATA[
		  		where delete_flag like concat('%',#{vo.deleteFlag},'%')
		   		]]>
			</if>
			
   			<if test='vo.name!=null and !("").equals(vo.name) '>
				<![CDATA[
					and name like concat('%',#{vo.name },'%')
				]]>
			</if>
			<if test='vo.store!=null and !("").equals(vo.store) '>
				<![CDATA[
					and store like concat('%',#{vo.store },'%')
				]]>
			</if>
			<if test='vo.dealDate!=null and !("").equals(vo.dealDate) '>
				<![CDATA[
					and date_format(deal_date,'%Y-%m-%d') like concat('%',#{vo.dealDate},'%')
				]]>
			</if>
			<if test="pagination.pageIndex >= 0">
				<![CDATA[
			    	limit #{pagination.pageIndex }, #{pagination.listSize }
			    ]]>
		    </if>
	</select>

</mapper>