<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="menu45">
	
	<!-- 은행테이블의 데이터 갯수 조회 -->
	<select id="selectBankListCount" resultType="int" parameterType="bankvo">
		<![CDATA[
			select	count(*)
				from tb_bank
				where delete_flag = 'N'
		]]>
			<if test="name!=null and !name.equals('')"> 
			<!-- code.length()>0 하면 에러남  -->
 			  <![CDATA[
  			 and name like concat('%',#{name},'%') 
   			]]>
   			</if>
   			<if test="store!=null and !store.equals('')"> 
			<!-- code.length()>0 하면 에러남  -->
 			  <![CDATA[
  			 and store like concat('%',#{store},'%') 
   			]]>
   			</if>
   			<if test="dealDate!=null and !dealDate.equals('')"> 
			<!-- code.length()>0 하면 에러남  -->
 			  <![CDATA[
  			 and date_format(dealDate,'%Y-%m-%d') like concat('%',#{deal_date},'%') 
   			]]>
   			</if>
	</select>
	
	<!-- select list -->
	<select id="list" resultType="bankvo" parameterType="map">
		<![CDATA[
			select 
				code,
				name,
				store,
				date_format(deal_date,'%Y/%m/%d') as dealDate,
				phone, 
				fax,
				post, 
				address,
				mgr, 
				mgr_phone as mgrPhone,
				mgr_email as mgrEmail
			from tb_bank
			where delete_flag = 'N' 
			]]>
			
   			<if test="vo.name!=null and !vo.name.equals('') ">
				<![CDATA[
					and name like concat('%',#{vo.name },'%')
				]]>
			</if>
			<if test="vo.store!=null and !vo.store.equals('') ">
				<![CDATA[
					and store like concat('%',#{vo.store },'%')
				]]>
			</if>
			<if test="vo.dealDate!=null and !vo.dealDate.equals('') ">
				<![CDATA[
					and date_format(dealDate,'%Y-%m-%d') like concat('%',#{vo.deal_date},'%')
				]]>
			</if>
			<if test="pagination.pageIndex >= 0">
				<![CDATA[
			    	limit #{pagination.pageIndex }, #{pagination.listSize }
			    ]]>
		    </if>
	</select>

</mapper>