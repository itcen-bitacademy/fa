<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="menu05">
	<!-- Test -->

	<insert id="create" parameterType="1cardvo">
		<![CDATA[
		insert into tb_cardmanager values (#{cardNo }, #{validity }, #{transportation }, #{limitation}, #{cvc }, 
		#{issuer }, #{user },  #{company },  #{abroad },  #{password },  #{depositNo },  
		#{insertUserId }, now(), null, null, "N")
		]]>
	</insert>

	<select id="list" resultType="1cardvo">
		<![CDATA[
		select	card_no as cardNo, validity, transportation, limitation, cvc, issuer, user, 
				company, abroad, password, deposit_no as depositNo,
				insert_userid as insertUserId, insert_day as insertDay, 
				update_userid as updateUserId, update_day as updateDay, 
				delete_flag as deleteFlag
		 from	tb_cardmanager
		 where	delete_flag = "N"
		]]>
	</select>

	<update id="remove" parameterType="1cardvo">
		<![CDATA[
			update 	tb_cardmanager 
			   set 	delete_flag='Y', card_no = concat("d",#{cardNo })
			 where 	card_no = #{cardNo };
			
		]]>
	</update>

	<update id="update" parameterType="1cardvo">
		<![CDATA[
		 update tb_cardmanager
	    	set card_no = #{cardNo },
	    		validity = #{validity },
	    		transportation = #{transportation },
	    		limitation = #{limitation},
	    		cvc = #{cvc }, 
	    		issuer = #{issuer },
	    		user = #{user },
	    		company =  #{company },
	    		abroad = #{abroad }, 	
	    		password =  #{password }, 
	    		deposit_no =  #{depositNo }, 
				update_userid = #{updateUserId},
				update_day = now()
		  where card_no = #{cardNoOld};
		]]>
	</update>

	<update id="delete" parameterType="1cardvo">
		<![CDATA[
			delete from tb_cardmanager where card_no = #{cardNo}
		]]>
	</update>




	<select id="Nexist" resultType="1cardvo">
		<![CDATA[
		select	card_no
		  from	tb_cardmanager 		  
		 where  card_no = concat("ddd",#{cardNo })
		]]>
		<if test="cardNo!=cardNoOld ">
		<![CDATA[
		or	 card_no = #{cardNo}
		]]>
		</if>
		
		
		
	</select>

	<select id="Yexist" resultType="1cardvo">
		<![CDATA[
		select	card_no
		 from	tb_cardmanager
		 where	card_no = concat("d",#{cardNo })
		]]>
	</select>


</mapper>